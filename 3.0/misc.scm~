(define balance 100)
(define (withdraw amount) 
  (if (<= amount balance)
      (begin (set! balance (- balance amount))
	     balance)
      ("insufficient balance")))
(define (deposit amount)
  (if (> amount 0)
      (begin (set! balance (+ balance amount))
	     balance)
      ("insufficient amount")))

(define (make-account balance) 
  (define (withdraw amount)
    (if (<= amount balance)
	(begin (set! balance (- balance amount))
	       balance)
	"insufficient balance"))
  (define (deposit amount)
    (if (> amount 0)
	(begin (set! balance (+ balance amount))
	       balance)
	"Insufficient funds"))
  (define (dispatch m)
    (cond ((eq? m 'withdraw) withdraw)
	  ((eq? m 'deposit) deposit)
	  (else (error "adsf" m))))
  dispatch)
  
    
	
  
      